<!-- Ultimate Game Stash file--> 
<!-- For the regularly updating doc go to https://docs.google.com/document/d/1_FmH3BlSBQI7FGgAQL59-ZPe8eCxs35wel6JUyVaG8Q/ -->
<!-- Made by Genizy--> 

<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<script language="JavaScript" type="text/javascript">
	window.onbeforeunload = function(e) {
    var message = "click no/cancel or you will be sent to sitelock", e = e || window.event;
if (e) {
    e.returnValue = message;
}
    return message;
};
	</script>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>Blockpost - Poki</title>
	<script>
	window.config = {
		loader: 'unity',
		debug: false,
		maxRatio: 16 / 9,
		minRatio: 9 / 16,

		title: 'Blockpost',

		unityVersion: '2018.4.32f1',
		unityWebglBuildUrl: 'Build/webgl_poki.json',

		fileSize:  20 ,
		cachedDecompressedFileSizes: {
			'webgl_poki.data.unityweb':  11067985 ,
			'webgl_poki.wasm.code.unityweb':  9830263 ,
			'webgl_poki.wasm.framework.unityweb':  100563 ,
		},
	};

	window.mergedBlobUrls = {};
	window.assetsReady = false;

	async function mergeSplitFile(fileUrlBase, numParts = 3) {
		const partUrls = Array.from({ length: numParts }, (_, i) => 
			`${fileUrlBase}.part${i + 1}`
		);

		try {
			const responses = await Promise.all(
				partUrls.map(url => fetch(url))
			);

			if (responses.some(r => !r.ok)) {
				return null;
			}

			const parts = await Promise.all(
				responses.map(r => r.arrayBuffer())
			);

			const combinedBlob = new Blob(parts, {
				type: 'application/octet-stream'
			});

			return URL.createObjectURL(combinedBlob);
		} catch (error) {
			return null;
		}
	}

	function setupXHRInterceptor() {
		if (window.xhrInterceptorInstalled) {
			return;
		}
		
		const originalOpen = XMLHttpRequest.prototype.open;
		const originalSend = XMLHttpRequest.prototype.send;

		XMLHttpRequest.prototype.open = function(method, url, ...args) {
			this._url = url;
			this._method = method;
			this._args = args;
			
			let finalUrl = url;
			
			for (const [filename, blobUrl] of Object.entries(window.mergedBlobUrls)) {
				if (url.includes(filename)) {
					finalUrl = blobUrl;
					break;
				}
			}
			
			return originalOpen.call(this, method, finalUrl, ...args);
		};

		XMLHttpRequest.prototype.send = function(...args) {
			const xhr = this;
			
			if (!window.assetsReady) {
				const checkReady = setInterval(() => {
					if (window.assetsReady) {
						clearInterval(checkReady);
						originalSend.apply(xhr, args);
					}
				}, 50);
				return;
			}
			
			return originalSend.apply(this, args);
		};
		
		window.xhrInterceptorInstalled = true;
	}

	async function prepareGameAssets() {
		try {
			window.assetsReady = false;
			delete window.xhrInterceptorInstalled;
			window.mergedBlobUrls = {};
			
			setupXHRInterceptor();
			
			// Add all files you need to merge here with their part counts
			const filesToMerge = [
				{ file: 'Build/webgl_poki.wasm.code.unityweb', parts: 3 },
			];
			
			for (const { file, parts } of filesToMerge) {
				const blobUrl = await mergeSplitFile(file, parts);
				if (blobUrl) {
					window.mergedBlobUrls[file] = blobUrl;
				}
			}
			
			window.assetsPrepared = true;
			window.assetsReady = true;
			
		} catch (error) {
			window.assetsPrepared = false;
			window.assetsReady = true;
		}
	}

	prepareGameAssets();
	</script>
</head>
<body>
	<script src="master-loader.js"></script>
</body>
</html>